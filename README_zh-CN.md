# PDF 处理工具箱

专为 OOMOL 平台打造的全面 PDF 处理块集合，提供强大的文档操作、转换和增强工具。

## 🚀 概述

本工具箱将您的 OOMOL 工作空间转变为完整的 PDF 处理中心。凭借 15+ 个专业化功能块，您可以处理从合并、拆分等基本操作到 OCR、表单填充和安全管理等高级功能的所有任务。

## 📦 可用功能块

### 🔧 **核心 PDF 操作**

#### **PDF 水印** (`pdf_watermark`)
为 PDF 添加专业水印，提供完整的自定义选项。
- **文本/图片水印**: 支持文本和图片叠加
- **位置控制**: 通过 X/Y 坐标精确定位
- **样式选项**: 透明度、旋转、大小、颜色和字体自定义
- **批量处理**: 在多个文档间应用一致的水印

#### **PDF 压缩** (`pdf_compress`)
在保持质量的同时减小 PDF 文件大小，实现高效存储和共享。
- **多级压缩**: 低、中、高和最大压缩级别
- **智能优化**: 图片质量调整和重复内容删除
- **大小分析**: 压缩前后文件大小对比及压缩率统计
- **质量控制**: 在减小文件大小的同时保持文档可读性

#### **PDF 合并** (`pdf_merge`)
将多个 PDF 文档合并为单个专业文档。
- **批量合并**: 同时处理多个输入文件
- **书签保留**: 保持源文档的导航结构
- **页码编号**: 可选为合并内容添加连续页码
- **元数据处理**: 保留文档属性和结构

#### **PDF 拆分** (`pdf_split`)
通过灵活的拆分选项将大型 PDF 分割为更小、更易管理的文件。
- **多种拆分模式**: 单页、页面范围、书签或等分
- **自定义范围**: 指定具体页面，如 "1-3,5-7,10"
- **基于书签**: 自动在书签边界处拆分
- **批量输出**: 使用有组织的命名规则生成多个文件

### 🔒 **安全与访问控制**

#### **PDF 加密** (`pdf_encrypt`)
使用高级密码和权限控制保护敏感文档。
- **双密码系统**: 分离的用户密码和所有者密码
- **权限管理**: 控制打印、复制和修改权限
- **128 位加密**: 行业标准的文档保护安全性
- **批量安全**: 在多个文件间应用一致的安全策略

#### **PDF 解密** (`pdf_decrypt`)
从授权文档中移除密码保护。
- **密码恢复**: 使用有效凭据解锁文档
- **批量处理**: 同时解密多个受保护文件
- **状态报告**: 验证加密状态和成功解密
- **安全处理**: 安全处理敏感文档凭据

### 🎨 **内容操作**

#### **PDF 旋转** (`pdf_rotate`)
通过精确的页面旋转控制纠正文档方向。
- **标准角度**: 90°、180° 和 270° 旋转选项
- **选择性页面**: 旋转特定页面或页面范围
- **批量旋转**: 对多个文档应用一致的旋转
- **预览支持**: 处理前的可视化确认

#### **PDF 文本提取** (`pdf_extract_text`)
以多种格式提取和导出文本内容以供进一步处理。
- **多种格式**: 纯文本、JSON 或 CSV 输出选项
- **布局保留**: 保持原始文档格式
- **选择性提取**: 处理特定页面或页面范围
- **批量导出**: 同时从多个文档提取文本

#### **PDF 页面管理** (`pdf_delete_pages`, `pdf_insert_pages`)
使用高级页面操作工具微调文档结构。
- **页面删除**: 通过范围规范删除不需要的页面
- **页面插入**: 在特定位置添加来自其他 PDF 的内容
- **批量操作**: 使用一致的规则处理多个文档
- **结构保留**: 在修改期间保持文档完整性

### 🤖 **高级 AI 功能**

#### **PDF OCR** (`pdf_ocr`)
使用先进的 OCR 技术将扫描文档转换为可搜索、可编辑的文本。
- **多语言支持**: 处理英语、中文、日语、韩语和欧洲语言文档
- **质量控制**: 可调节的 DPI 设置（150-600）以实现最佳识别
- **置信度评分**: 用于质量保证的准确性指标
- **可搜索输出**: 生成带有不可见文本层的完全可搜索 PDF

### 📝 **交互式文档**

#### **PDF 表单填充** (`pdf_fill_forms`)
通过程序化字段填充自动完成表单。
- **字段检测**: 自动识别可填充表单字段
- **数据映射**: 用于一致表单完成的结构化输入
- **批量处理**: 使用模板数据填充多个表单
- **验证**: 确保字段兼容性和数据完整性

#### **PDF 注释** (`pdf_annotate`)
使用专业的注释和标记工具增强文档。
- **多种类型**: 文本、高亮、笔记和自定义印章
- **精确定位**: 基于坐标的放置系统
- **颜色自定义**: 用于可视化组织的完整调色板
- **协作功能**: 用于文档审阅的专业标记

### 🌐 **格式转换**

#### **HTML 转 PDF** (`html_to_pdf`)
将网页内容和 HTML 文档转换为专业 PDF 格式。
- **多种来源**: HTML 文件、原始字符串或实时网页 URL
- **布局控制**: 自定义页面大小、方向和边距
- **CSS 支持**: 转换期间完整保留样式
- **打印优化**: 适合打印和归档的专业输出

### 🔖 **文档组织**

#### **PDF 书签管理** (`pdf_bookmarks`)
使用专业书签系统创建和管理文档导航。
- **层次结构**: 支持嵌套书签组织
- **批量导入/导出**: 在多个文档间管理书签
- **自定义命名**: 灵活的书签标题和组织
- **导航增强**: 提高文档可用性和可访问性

## 🛠️ 技术规格

### **依赖项**
- **PyPDF/PyPDF2**: 核心 PDF 操作引擎
- **Reportlab**: 高级 PDF 生成和叠加功能
- **PDFplumber**: 带布局保留的增强文本提取
- **Pytesseract**: 工业级 OCR 处理
- **WeasyPrint**: 专业的 HTML 到 PDF 转换
- **Wand/ImageMagick**: 高级图像处理功能

### **性能特性**
- **内存高效**: 针对大文件处理进行优化
- **批量操作**: 同时处理多个文档
- **错误处理**: 全面的错误报告和恢复
- **进度跟踪**: 实时处理状态和完成度指标

### **集成优势**
- **OOMOL 原生**: 与 OOMOL 工作流系统无缝集成
- **模块化设计**: 混合搭配块以创建自定义处理管道
- **标准接口**: 所有块间一致的输入/输出格式
- **可视化 UI**: 带有可视化文件选择器和控件的直观配置

## 🎯 使用场景

### **商业文档管理**
- **发票处理**: 提取文本、添加水印并保护敏感财务文档
- **报告生成**: 合并部门报告、添加页码并应用企业品牌
- **合同管理**: 填充表单、添加注释并实施安全控制

### **教育内容**
- **讲座材料**: 转换演示幻灯片、提取阅读材料并组织内容
- **研究论文**: 合并引用、提取参考文献并应用学术格式
- **学生提交**: 处理作业、添加反馈注释并管理文档集合

### **数字出版**
- **内容创作**: 转换网络文章、添加专业布局并优化分发
- **档案管理**: 使用 OCR 数字化纸质文档、用书签组织并保护敏感材料
- **作品集开发**: 合并创意作品、添加水印并准备专业演示

### **法律与合规**
- **文档编辑**: 在保持文档完整性的同时删除敏感信息
- **证据管理**: 使用加密保护文档、添加案件笔记注释
- **监管提交**: 合并合规文档、添加所需元数据并确保正确格式

## 🚦 快速开始

1. **安装依赖**: 通过 `pip install` 或 `poetry install` 确保安装所有必需的 Python 包
2. **导入功能块**: 将所需的 PDF 处理块添加到您的 OOMOL 工作流
3. **配置设置**: 根据您的具体用例自定义块参数
4. **处理文档**: 执行工作流并监控处理结果
5. **导出结果**: 下载处理后的文档或继续进行其他处理步骤

## 📈 高级工作流

组合多个功能块创建强大的文档处理管道：

- **文档数字化**: OCR → 文本提取 → 书签创建
- **安全管道**: 加密 → 水印 → 压缩
- **出版工作流**: HTML 转换 → 合并 → 页码编号 → 最终压缩
- **档案处理**: 拆分 → 单独 OCR → 元数据提取 → 安全存储

使用这个为专业工作流和 OOMOL 平台无缝集成而设计的全面 PDF 工具箱，转变您的文档处理能力。